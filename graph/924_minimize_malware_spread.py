from typing import List


class Solution:
    def minMalwareSpread(self, G: List[List[int]], initial: List[int]) -> int:
        n = len(G)
        parent = [-1] * n

        def dfs(u):
            for v in range(n):
                if G[u][v] == 0:
                    continue
                if parent[v] == -1:
                    parent[v] = parent[u]
                    dfs(v)
                elif parent[v] != -2 and parent[v] != parent[u]:
                    parent[v] = -2
                    dfs(v)

        for u in initial:
            if parent[u] == -2:
                continue
            if parent[u] != -1:
                parent[u] = -2
            else:
                parent[u] = u
            dfs(u)

        mx = -1
        ans = -1
        for u in initial:
            c = parent.count(u)
            if c > mx or (c == mx and u < ans):
                mx = c
                ans = u
        return ans